jQuery(document).ready(function(t){function e(t,e,i){if(0===i)document.cookie=t+"="+e+";path=/;";else{var a=new Date;a.setTime(a.getTime()+24*i*60*60*1e3),document.cookie=t+"="+e+";path=/;expires="+a.toUTCString()}}t(document).on("submit",".fca_eoi_form",function(i){i.preventDefault();var a,o=t(this),n=t("[name=email]",o),r=t("[name=name]:visible",o),c=r.val(),l=n.val(),_=o.data("fca_eoi_list_id"),s=t("[type=submit]",o),d=o.data("fca_eoi_thank_you_mode"),p=o.data("fca_eoi_thank_you_page"),f=o.data("fca_eoi_success_cookie_duration"),u=o.data("fca_eoi_sub_msg"),m=!1,h=t("[name=fca_eoi_form_id]",o).val();if(o.find(".tooltipstered").tooltipster("hide"),t("[name=email], [name=name]",o).not(".tooltipstered").each(function(){var e=t(this),i=.8*e.width();e.tooltipster({contentAsHTML:!0,fixedWidth:i,minWidth:i,maxWidth:i,trigger:"none",theme:["tooltipster-borderless","tooltipster-optin-cat"]})}),t("[name=email], [name=name]",t(this)).focus(function(){var e=t(this),i=t("[type=submit]",e.closest(".fca_eoi_form")),a=i.data("fca_eoi_initial_val");void 0!==a&&i.val(a),t(this).tooltipster("hide")}),s.data("fca_eoi_initial_val")?a=s.data("fca_eoi_initial_val"):(a=s.val(),s.data("fca_eoi_initial_val",a)),s.val(a),fcaEoiScriptData.invalid_email=o.find(".fca_eoi_error_texts_email").val(),fcaEoiScriptData.field_required=o.find(".fca_eoi_error_texts_required").val(),l&&function(t){return/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(t)}(l)||(n.tooltipster("content",l?fcaEoiScriptData.invalid_email:fcaEoiScriptData.field_required),n.tooltipster("show"),s.val("✗ "+a),m=!0),r.length&&!c&&(r.tooltipster("content",fcaEoiScriptData.field_required),r.tooltipster("show"),s.val("✗ "+a),m=!0),m)return!1;var v="unknown";if(fcaEoiScriptData.gdpr_checkbox){if(0===o.find(".fca_eoi_gdpr_consent").length)return o.find(".fca_eoi_layout_field_wrapper").hide(),o.find(".fca_eoi_layout_email_field_inner").hide(),o.find(".fca_eoi_layout_name_field_inner").hide(),o.closest(".fca_eoi_form_wrapper ").hasClass("fca_eoi_layout_banner_wrapper")?o.find(".fca_eoi_layout_headline_copy_wrapper").html('<div style="font-size: 14px;">'+fcaEoiScriptData.consent_headline+'<br><label><input class="fca_eoi_gdpr_consent" value="" type="checkbox"></input>'+fcaEoiScriptData.consent_msg+"</label></div>"):o.find(".fca_eoi_layout_description_copy_wrapper").html('<div style="text-align:left;">'+fcaEoiScriptData.consent_headline+'<br><br><label><input class="fca_eoi_gdpr_consent" value="" type="checkbox"></input>'+fcaEoiScriptData.consent_msg+"</label></div>"),!1;0==(v=o.find(".fca_eoi_gdpr_consent").prop("checked"))&&o.find(".fca_eoi_gdpr_consent").not(".tooltipstered").tooltipster({contentAsHTML:!0,trigger:"none",theme:["tooltipster-borderless","tooltipster-optin-cat"]}).tooltipster("content",fcaEoiScriptData.field_required).tooltipster("show")}s.val(u),s.prop("disabled",!0);var b=jstz.determine();t.ajax({url:fcaEoiScriptData.ajax_url,data:{email:l,name:c,action:"fca_eoi_subscribe",list_id:_,form_id:h,nonce:fcaEoiScriptData.nonce,timezone:b.name(),consent_granted:v},type:"POST",datatype:"text",timeout:15e3}).done(function(i){if("✓"===i){s.val(i+" "+a),e("fca_eoi_success_"+h,Math.floor(Date.now()/1e3),f);var c=JSON.parse(function(t){var e=("; "+document.cookie).split("; "+t+"=");return 2===e.length&&e.pop().split(";").shift()}("fca_eoi_active_optins"));Array.isArray(c)||(c=[]);var l=c.indexOf(h);-1!==l&&c.splice(l,1),e("fca_eoi_active_optins",JSON.stringify(c))}else"✗ Failed to add user - denied"===i?(s.prop("disabled",!1),s.val(a),o.find(".fca_eoi_gdpr_consent").tooltipster("show")):(s.prop("disabled",!1),s.val(i));"ajax"===d&&"✓"===i?(clearInterval(!1),p&&"✓"===i&&(tooltipWidth=s.width(),s.tooltipster({contentAsHTML:!0,trigger:"none",fixedWidth:tooltipWidth,minWidth:tooltipWidth,maxWidth:tooltipWidth,arrow:!1,theme:["tooltipster-borderless","tooltipster-optin-cat"]}),s.tooltipster("content",p),s.tooltipster("show"),n.prop("disabled",!0),r.prop("disabled",!0),t(".tooltipster-content").css("background-color","#148544"))):"✓"===i&&(window.location.href=p)})})});